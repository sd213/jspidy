package creationupdationdeletion3;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.Statement;
import java.util.Scanner;

public class EmployeeManagement {
	static Scanner sc = new Scanner(System.in);
	static Connection con = null;
	static Statement s = null;
	static PreparedStatement ps = null;
	static String url = "jdbc:mysql://localhost:3306/";
	static String user = "root";
	static String pass = "toor";
	static String db;
	static String table;
	static String sql;
//	static int option;
	
	public static void main(String[] args) {
		int option ;
		boolean count = true;
		do {
			System.out.print("\n\nEnter Option:-\n1. Create DB and Table\n2. Insert Record\n3. Update Record\n4. Find Record\n5. Delete Record\n0. to exit\n Enter Option :- ");
			option = sc.nextInt() ;
			
			switch(option) {
			case 1:
				createDBandTable();
				break;
				
			case 2:
				insertRecord();
				break;
			
			case 3:
				updateRecord();
				break;
			case 4:
				findRecord();
				break;
			case 5:
				deleteRecord();
				break;
			
			case 0:
				count=false;
				break;
				
			default:
				System.out.println("Try Again \n\n");
			}	
			
			
		}while(count);
		
	}
	public static void createDBandTable() {
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");\
			System.out.println("Enter Database Name:- ");
			db = new java.util.Scanner(System.in).next();
			con = DriverManager.getConnection(url,user,pass);
			s = con.createStatement();
			
			sql = "CREATE DATABASE IF NOT EXISTS "+db;
			s.executeUpdate(sql);
			
			sql = "USE "+db;
			s.execute(sql);
			
			System.out.println("Enter Table Name:- ");
			table = new java.util.Scanner(System.in).next();
			sql = "CREATE TABLE IF NOT EXISTS "+table+"(id INT NOT NULL PRIMARY KEY, name VARCHAR(50),age INT,GENDER VARCHAR(50))";
			s.execute(sql);
			
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}finally {
			if(s!=null) {
				s.close();
			}
			if(con!=null) {
				con.close();
			}
		}
		
	}
	public static void insertRecord() {
		
	}
	public static void updateRecord() {
		
	}
	public static void findRecord() {
		
	}
	public static void deleteRecord() {
		
	}

}
